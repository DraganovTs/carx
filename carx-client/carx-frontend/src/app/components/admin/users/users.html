<div class="admin-users-page">
  <header class="admin-header">
    <h1>Manage Users</h1>
    <p>View and manage all registered users</p>
  </header>

  <main class="admin-content">
    @if (isLoading) {
      <div class="loading">Loading users...</div>
    } @else if (error) {
      <div class="error">{{ error }}</div>
    } @else {
      <div class="users-table-container">
        <table class="users-table">
          <thead>
            <tr>
              <th>ID</th>
              <th>Email</th>
              <th>Username</th>
              <th>Role</th>
              <th>Created</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            @for (user of users; track user.id) {
              <tr>
                <td>{{ user.id }}</td>
                <td>{{ user.email }}</td>
                <td>{{ user.username || 'N/A' }}</td>
                <td>
                  <select 
                    [(ngModel)]="user.role" 
                    (change)="updateUserRole(user.id, user.role)"
                    class="role-select"
                  >
                    <option value="USER">USER</option>
                    <option value="ADMIN">ADMIN</option>
                    <option value="MODERATOR">MODERATOR</option>
                  </select>
                </td>
                <td>{{ formatDate(user.createdAt) }}</td>
                <td>
                  <button 
                    class="btn-delete"
                    (click)="deleteUser(user.id)"
                    [disabled]="user.email === 'admin@abv.bg'"
                  >
                    Delete
                  </button>
                </td>
              </tr>
            } @empty {
              <tr>
                <td colspan="6" class="empty">No users found</td>
              </tr>
            }
          </tbody>
        </table>
      </div>
    }
  </main>
</div>